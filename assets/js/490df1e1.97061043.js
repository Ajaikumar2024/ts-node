"use strict";(self.webpackChunk_ts_node_website=self.webpackChunk_ts_node_website||[]).push([[376],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return N}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=n.createContext({}),p=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(i.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=p(a),N=o,k=c["".concat(i,".").concat(N)]||c[N]||m[N]||s;return a?n.createElement(k,r(r({ref:t},d),{},{components:a})):n.createElement(k,r({ref:t},d))}));function N(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=a.length,r=new Array(s);r[0]=c;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var p=2;p<s;p++)r[p]=a[p];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},3911:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return i},default:function(){return N},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return m}});var n=a(7462),o=a(3366),s=(a(7294),a(3905)),r=["components"],l={title:"CommonJS vs native ECMAScript modules",slug:"imports"},i=void 0,p={unversionedId:"commonjs-vs-native-ecmascript-modules",id:"commonjs-vs-native-ecmascript-modules",title:"CommonJS vs native ECMAScript modules",description:"TypeScript is almost always written using modern import syntax, but it is also transformed before being executed by the underlying runtime.  You can choose to either transform to CommonJS or to preserve the native import syntax, using node's native ESM support.  Configuration is different for each.",source:"@site/docs/commonjs-vs-native-ecmascript-modules.md",sourceDirName:".",slug:"/imports",permalink:"/ts-node/docs/imports",editUrl:"https://github.com/TypeStrong/ts-node/edit/docs/website/docs/commonjs-vs-native-ecmascript-modules.md",tags:[],version:"current",frontMatter:{title:"CommonJS vs native ECMAScript modules",slug:"imports"},sidebar:"primarySidebar",previous:{title:"SWC",permalink:"/ts-node/docs/swc"},next:{title:"Troubleshooting",permalink:"/ts-node/docs/troubleshooting"}},d={},m=[{value:"CommonJS",id:"commonjs",level:2},{value:"Native ECMAScript modules",id:"native-ecmascript-modules",level:2}],c={toc:m};function N(e){var t=e.components,a=(0,o.Z)(e,r);return(0,s.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"TypeScript is almost always written using modern ",(0,s.kt)("inlineCode",{parentName:"p"},"import")," syntax, but it is also transformed before being executed by the underlying runtime.  You can choose to either transform to CommonJS or to preserve the native ",(0,s.kt)("inlineCode",{parentName:"p"},"import")," syntax, using node's native ESM support.  Configuration is different for each."),(0,s.kt)("p",null,"Here is a brief comparison of the two."),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:null},"CommonJS"),(0,s.kt)("th",{parentName:"tr",align:null},"Native ECMAScript modules"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Write native ",(0,s.kt)("inlineCode",{parentName:"td"},"import")," syntax"),(0,s.kt)("td",{parentName:"tr",align:null},"Write native ",(0,s.kt)("inlineCode",{parentName:"td"},"import")," syntax")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Transforms ",(0,s.kt)("inlineCode",{parentName:"td"},"import")," into ",(0,s.kt)("inlineCode",{parentName:"td"},"require()")),(0,s.kt)("td",{parentName:"tr",align:null},"Does not transform ",(0,s.kt)("inlineCode",{parentName:"td"},"import"))),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Node executes scripts using the classic ",(0,s.kt)("a",{parentName:"td",href:"https://nodejs.org/dist/latest-v16.x/docs/api/modules.html"},"CommonJS loader")),(0,s.kt)("td",{parentName:"tr",align:null},"Node executes scripts using the new ",(0,s.kt)("a",{parentName:"td",href:"https://nodejs.org/dist/latest-v16.x/docs/api/esm.html"},"ESM loader"))),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"Use any of:",(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"ts-node"),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"node -r ts-node/register"),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},'NODE_OPTIONS="ts-node/register" node'),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"require('ts-node').register({/* options */})")),(0,s.kt)("td",{parentName:"tr",align:null},"Use any of:",(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"ts-node --esm"),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"ts-node-esm"),(0,s.kt)("br",null),"Set ",(0,s.kt)("inlineCode",{parentName:"td"},'"esm": true')," in ",(0,s.kt)("inlineCode",{parentName:"td"},"tsconfig.json"),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},"node --loader ts-node/esm"),(0,s.kt)("br",null),(0,s.kt)("inlineCode",{parentName:"td"},'NODE_OPTIONS="--loader ts-node/esm" node'))))),(0,s.kt)("h2",{id:"commonjs"},"CommonJS"),(0,s.kt)("p",null,"Transforming to CommonJS is typically simpler and more widely supported because it is older.  You must remove ",(0,s.kt)("a",{parentName:"p",href:"https://nodejs.org/api/packages.html#packages_type"},(0,s.kt)("inlineCode",{parentName:"a"},'"type": "module"'))," from ",(0,s.kt)("inlineCode",{parentName:"p"},"package.json")," and set ",(0,s.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/tsconfig/#module"},(0,s.kt)("inlineCode",{parentName:"a"},'"module": "CommonJS"'))," in ",(0,s.kt)("inlineCode",{parentName:"p"},"tsconfig.json"),"."),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"package.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"package.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"// This can be omitted; commonjs is the default")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"type"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"commonjs"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"package.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"package.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"// This can be omitted; commonjs is the default")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"type"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"commonjs"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"compilerOptions"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"module"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"CommonJS"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  }")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"compilerOptions"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"module"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"CommonJS"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,s.kt)("p",null,"If you must keep ",(0,s.kt)("inlineCode",{parentName:"p"},'"module": "ESNext"')," for ",(0,s.kt)("inlineCode",{parentName:"p"},"tsc"),", webpack, or another build tool, you can set an override for ts-node."),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"compilerOptions"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"module"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"ESNext"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"ts-node"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"compilerOptions"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"      "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"module"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"CommonJS"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    }")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  }")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"compilerOptions"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"module"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"ESNext"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"},")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"ts-node"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"compilerOptions"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"      "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"module"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"CommonJS"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,s.kt)("h2",{id:"native-ecmascript-modules"},"Native ECMAScript modules"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://nodejs.org/api/esm.html#loaders"},"Node's ESM loader hooks")," are ",(0,s.kt)("a",{parentName:"p",href:"https://nodejs.org/api/documentation.html#documentation_stability_index"},(0,s.kt)("strong",{parentName:"a"},"experimental"))," and subject to change. ts-node's ESM support is as stable as possible, but it relies on APIs which node can ",(0,s.kt)("em",{parentName:"p"},"and will")," break in new versions of node.  Thus it is not recommended for production."),(0,s.kt)("p",null,"For complete usage, limitations, and to provide feedback, see ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/TypeStrong/ts-node/issues/1007"},"#1007"),"."),(0,s.kt)("p",null,"You must set ",(0,s.kt)("a",{parentName:"p",href:"https://nodejs.org/api/packages.html#packages_type"},(0,s.kt)("inlineCode",{parentName:"a"},'"type": "module"'))," in ",(0,s.kt)("inlineCode",{parentName:"p"},"package.json")," and ",(0,s.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/tsconfig/#module"},(0,s.kt)("inlineCode",{parentName:"a"},'"module": "ESNext"'))," in ",(0,s.kt)("inlineCode",{parentName:"p"},"tsconfig.json"),"."),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"package.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"package.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"type"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"module"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"package.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"package.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"type"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"module"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"compilerOptions"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"module"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"ESNext"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"// or ES2015, ES2020")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  },")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"ts-node"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"// Tell ts-node CLI to install the --loader automatically, explained below")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"esm"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,s.kt)("span",{parentName:"div",style:{color:"#005CC5"}},"true")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  }")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"tsconfig.json"},(0,s.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,s.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"compilerOptions"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"module"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"ESNext"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"// or ES2015, ES2020")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"},")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"ts-node"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"// Tell ts-node CLI to install the --loader automatically, explained below")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"esm"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,s.kt)("span",{parentName:"div",style:{color:"#81A1C1"}},"true")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,s.kt)("p",null,"You must also ensure node is passed ",(0,s.kt)("inlineCode",{parentName:"p"},"--loader"),".  The ts-node CLI will do this automatically with our ",(0,s.kt)("inlineCode",{parentName:"p"},"esm")," option."),(0,s.kt)("blockquote",null,(0,s.kt)("p",{parentName:"blockquote"},"Note: ",(0,s.kt)("inlineCode",{parentName:"p"},"--esm")," must spawn a child process to pass it ",(0,s.kt)("inlineCode",{parentName:"p"},"--loader"),".  This may change if node adds the ability to install loader hooks\ninto the current process.")),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light",style:{backgroundColor:"#ffffff",color:"#24292e"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"shell"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"# pass the flag")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"ts-node --esm")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"# Use the convenience binary")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"ts-node-esm")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},'# or add `"esm": true` to your tsconfig.json to make it automatic')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"ts-node"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"shell"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"# pass the flag")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"ts-node --esm")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"# Use the convenience binary")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"ts-node-esm")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},'# or add `"esm": true` to your tsconfig.json to make it automatic')),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"ts-node")))))),(0,s.kt)("p",null,"If you are not using our CLI, pass the loader flag to node."),(0,s.kt)("div",{className:"shiki-twoslash-fragment"},(0,s.kt)("pre",{parentName:"div",className:"shiki github-light",style:{backgroundColor:"#ffffff",color:"#24292e"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"shell"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"node --loader ts-node/esm ./index.ts")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#6A737D"}},"# Or via environment variable")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}},"NODE_OPTIONS="),(0,s.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"--loader ts-node/esm"'),(0,s.kt)("span",{parentName:"div",style:{color:"#24292E"}}," node ./index.ts"))))),(0,s.kt)("pre",{parentName:"div",className:"shiki nord",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"}},(0,s.kt)("div",{parentName:"pre",className:"language-id"},"shell"),(0,s.kt)("div",{parentName:"pre",className:"code-container"},(0,s.kt)("code",{parentName:"div"},(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"node --loader ts-node/esm ./index.ts")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#616E88"}},"# Or via environment variable")),(0,s.kt)("div",{parentName:"code",className:"line"},(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"NODE_OPTIONS="),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"--loader ts-node/esm"),(0,s.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,s.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," node ./index.ts")))))))}N.isMDXComponent=!0}}]);