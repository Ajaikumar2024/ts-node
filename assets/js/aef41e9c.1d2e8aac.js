"use strict";(self.webpackChunk_ts_node_website=self.webpackChunk_ts_node_website||[]).push([[986],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return N}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),m=p(a),N=o,k=m["".concat(l,".").concat(N)]||m[N]||c[N]||r;return a?n.createElement(k,s(s({ref:t},d),{},{components:a})):n.createElement(k,s({ref:t},d))}));function N(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var p=2;p<r;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},6441:function(e,t,a){a.r(t),a.d(t,{assets:function(){return d},contentTitle:function(){return l},default:function(){return N},frontMatter:function(){return i},metadata:function(){return p},toc:function(){return c}});var n=a(7462),o=a(3366),r=(a(7294),a(3905)),s=["components"],i={title:"Module type overrides"},l=void 0,p={unversionedId:"module-type-overrides",id:"module-type-overrides",title:"Module type overrides",description:"Wherever possible, it is recommended to use TypeScript's NodeNext or Node16 mode instead of the options described",source:"@site/docs/module-type-overrides.md",sourceDirName:".",slug:"/module-type-overrides",permalink:"/ts-node/docs/module-type-overrides",editUrl:"https://github.com/TypeStrong/ts-node/edit/docs/website/docs/module-type-overrides.md",tags:[],version:"current",frontMatter:{title:"Module type overrides"},sidebar:"primarySidebar",previous:{title:"Transpilers",permalink:"/ts-node/docs/transpilers"},next:{title:"API",permalink:"/ts-node/docs/api"}},d={},c=[{value:"Caveats",id:"caveats",level:2}],m={toc:c};function N(e){var t=e.components,a=(0,o.Z)(e,s);return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Wherever possible, it is recommended to use TypeScript's ",(0,r.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/docs/handbook/esm-node.html"},(0,r.kt)("inlineCode",{parentName:"a"},"NodeNext")," or ",(0,r.kt)("inlineCode",{parentName:"a"},"Node16")," mode")," instead of the options described\nin this section.  Setting ",(0,r.kt)("inlineCode",{parentName:"p"},'"module": "NodeNext"')," and using the ",(0,r.kt)("inlineCode",{parentName:"p"},".cts")," file extension should work well for most projects.")),(0,r.kt)("p",null,"When deciding how a file should be compiled and executed -- as either CommonJS or native ECMAScript module -- ts-node matches\n",(0,r.kt)("inlineCode",{parentName:"p"},"node")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"tsc")," behavior.  This means TypeScript files are transformed according to your ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," ",(0,r.kt)("inlineCode",{parentName:"p"},'"module"'),"\noption and executed according to node's rules for the ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," ",(0,r.kt)("inlineCode",{parentName:"p"},'"type"')," field.  Set ",(0,r.kt)("inlineCode",{parentName:"p"},'"module": "NodeNext"')," and everything should work."),(0,r.kt)("p",null,"In rare cases, you may need to override this behavior for some files.  For example, some tools read a ",(0,r.kt)("inlineCode",{parentName:"p"},"name-of-tool.config.ts"),"\nand require that file to execute as CommonJS.  If you have ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," configured with ",(0,r.kt)("inlineCode",{parentName:"p"},'"type": "module"')," and ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," with\n",(0,r.kt)("inlineCode",{parentName:"p"},'"module": "esnext"'),", the config is native ECMAScript by default and will raise an error.  You will need to force the config and\nany supporting scripts to execute as CommonJS."),(0,r.kt)("p",null,"In these situations, our ",(0,r.kt)("inlineCode",{parentName:"p"},"moduleTypes")," option can override certain files to be\nCommonJS or ESM.  Similar overriding is possible by using ",(0,r.kt)("inlineCode",{parentName:"p"},".mts"),", ",(0,r.kt)("inlineCode",{parentName:"p"},".cts"),", ",(0,r.kt)("inlineCode",{parentName:"p"},".cjs")," and ",(0,r.kt)("inlineCode",{parentName:"p"},".mjs")," file extensions.\n",(0,r.kt)("inlineCode",{parentName:"p"},"moduleTypes")," achieves the same effect for ",(0,r.kt)("inlineCode",{parentName:"p"},".ts")," and ",(0,r.kt)("inlineCode",{parentName:"p"},".js")," files, and ",(0,r.kt)("em",{parentName:"p"},"also")," overrides your ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," ",(0,r.kt)("inlineCode",{parentName:"p"},'"module"'),"\nconfig appropriately."),(0,r.kt)("p",null,"The following example tells ts-node to execute a webpack config as CommonJS:"),(0,r.kt)("div",{className:"shiki-twoslash-fragment"},(0,r.kt)("pre",{parentName:"div",className:"shiki github-light with-title",style:{backgroundColor:"#ffffff",color:"#24292e"},title:"tsconfig.json"},(0,r.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,r.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,r.kt)("div",{parentName:"pre",className:"code-container"},(0,r.kt)("code",{parentName:"div"},(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"{")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"ts-node"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"transpileOnly"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},"true"),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"moduleTypes"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"webpack.config.ts"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,r.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"cjs"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#6A737D"}},'// Globs are also supported with the same behavior as tsconfig "include"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"webpack-config-scripts/**/*"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,r.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"cjs"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    }")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  },")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"compilerOptions"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": {")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"module"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,r.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"es2020"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#005CC5"}},'"target"'),(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},": "),(0,r.kt)("span",{parentName:"div",style:{color:"#032F62"}},'"es2020"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"  }")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#24292E"}},"}"))))),(0,r.kt)("pre",{parentName:"div",className:"shiki nord with-title",style:{backgroundColor:"#2e3440ff",color:"#d8dee9ff"},title:"tsconfig.json"},(0,r.kt)("div",{parentName:"pre",className:"code-title"},"tsconfig.json"),(0,r.kt)("div",{parentName:"pre",className:"language-id"},"json"),(0,r.kt)("div",{parentName:"pre",className:"code-container"},(0,r.kt)("code",{parentName:"div"},(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"ts-node"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"transpileOnly"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#81A1C1"}},"true"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"moduleTypes"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"webpack.config.ts"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"cjs"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#616E88"}},'// Globs are also supported with the same behavior as tsconfig "include"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"      "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"webpack-config-scripts/**/*"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"cjs"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"},")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"compilerOptions"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"{")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"module"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"es2020"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},",")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"    "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#8FBCBB"}},"target"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},":"),(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}}," "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"'),(0,r.kt)("span",{parentName:"div",style:{color:"#A3BE8C"}},"es2020"),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},'"')),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#D8DEE9FF"}},"  "),(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")),(0,r.kt)("div",{parentName:"code",className:"line"},(0,r.kt)("span",{parentName:"div",style:{color:"#ECEFF4"}},"}")))))),(0,r.kt)("p",null,"Each key is a glob pattern with the same syntax as tsconfig's ",(0,r.kt)("inlineCode",{parentName:"p"},'"include"')," array.\nWhen multiple patterns match the same file, the last pattern takes precedence."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cjs")," overrides matches files to compile and execute as CommonJS."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"esm")," overrides matches files to compile and execute as native ECMAScript modules."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"package")," resets either of the above to default behavior, which obeys ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")," ",(0,r.kt)("inlineCode",{parentName:"li"},'"type"')," and ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.json")," ",(0,r.kt)("inlineCode",{parentName:"li"},'"module"')," options.")),(0,r.kt)("h2",{id:"caveats"},"Caveats"),(0,r.kt)("p",null,"Files with an overridden module type are transformed with the same limitations as ",(0,r.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/tsconfig#isolatedModules"},(0,r.kt)("inlineCode",{parentName:"a"},"isolatedModules")),".  This will only affect rare cases such as using ",(0,r.kt)("inlineCode",{parentName:"p"},"const enum"),"s with ",(0,r.kt)("a",{parentName:"p",href:"https://www.typescriptlang.org/tsconfig#preserveConstEnums"},(0,r.kt)("inlineCode",{parentName:"a"},"preserveConstEnums"))," disabled."),(0,r.kt)("p",null,"This feature is meant to facilitate scenarios where normal ",(0,r.kt)("inlineCode",{parentName:"p"},"compilerOptions")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," configuration is not possible.  For example, a ",(0,r.kt)("inlineCode",{parentName:"p"},"webpack.config.ts")," cannot be given its own ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," to override ",(0,r.kt)("inlineCode",{parentName:"p"},'"type"'),".  Wherever possible you should favor using traditional ",(0,r.kt)("inlineCode",{parentName:"p"},"package.json")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," configurations."))}N.isMDXComponent=!0}}]);